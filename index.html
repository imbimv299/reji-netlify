<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>æœ¬ç‰©é¢¨ æ¥­å‹™ç”¨ãƒ¬ã‚¸</title>
  <style>
    body {
      margin: 0;
      font-family: 'Meiryo', sans-serif;
      background-color: #1a1a1a;
      color: white;
    }
    header {
      background-color: #002f6c;
      padding: 10px 20px;
      font-size: 20px;
      font-weight: bold;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 2px solid #444;
    }
    #login-screen, #main {
      display: none;
    }
    #login-screen.active, #main.active {
      display: block;
    }
    .login-box {
      text-align: center;
      margin-top: 20%;
    }
    .login-box input {
      padding: 10px;
      margin: 10px;
      font-size: 16px;
      width: 200px;
    }
    .login-box button {
      padding: 10px 20px;
      font-size: 16px;
      background-color: #004b8d;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .container {
      display: flex;
      padding: 20px;
      gap: 20px;
    }
    .products {
      flex: 2;
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
    }
    .products button {
      background-color: #eee;
      color: black;
      border-radius: 8px;
      font-size: 20px;
      padding: 20px;
      border: 2px solid #888;
      cursor: pointer;
      transition: transform 0.1s;
    }
    .products button:active {
      transform: scale(0.95);
    }
    .receipt-panel {
      flex: 1;
      background-color: #fff;
      color: black;
      padding: 10px;
      font-family: monospace;
      font-size: 14px;
      border-radius: 10px;
      min-height: 300px;
    }
    .controls {
      margin-top: 10px;
    }
    .controls button {
      padding: 10px;
      width: 100%;
      margin-top: 5px;
      font-size: 16px;
      background-color: #0078d7;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .stock-warning {
      color: red;
      font-weight: bold;
    }
  </style>
</head>
<body>

<div id="login-screen" class="active">
  <div class="login-box">
    <h2>ğŸ” æ¥­å‹™ç”¨ãƒ¬ã‚¸ãƒ­ã‚°ã‚¤ãƒ³</h2>
    <input type="text" id="username" placeholder="ãƒ¦ãƒ¼ã‚¶ãƒ¼å"><br>
    <input type="password" id="password" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰"><br>
    <button onclick="login()">ãƒ­ã‚°ã‚¤ãƒ³</button>
    <p id="login-error" style="color: red;"></p>
  </div>
</div>

<div id="main">
  <header>
    <div>ğŸª ãƒ¬ã‚¸ã‚·ã‚¹ãƒ†ãƒ </div>
    <div id="clock"></div>
  </header>

  <div class="container">
    <div class="products" id="product-list"></div>
    <div>
      <div class="receipt-panel" id="receipt"></div>
      <div class="controls">
        <button onclick="pay()">ğŸ’´ ä¼šè¨ˆ</button>
        <button onclick="exportCSV()">ğŸ“„ CSVå‡ºåŠ›</button>
        <button onclick="addProduct()">â• å•†å“è¿½åŠ </button>
      </div>
    </div>
  </div>
</div>

<audio id="beep" src="https://www.soundjay.com/button/beep-07.wav" preload="auto"></audio>
<audio id="pay-sound" src="https://www.soundjay.com/button/beep-10.wav" preload="auto"></audio>

<script>
  const credentials = {
    "demo": "1234",
    "admin": "adminpass"
  };

  const products = [
    { name: "ã‚Šã‚“ã” ğŸ", price: 100, stock: 5 },
    { name: "ãƒãƒŠãƒŠ ğŸŒ", price: 120, stock: 3 },
    { name: "ç‰›ä¹³ ğŸ¥›", price: 180, stock: 2 }
  ];

  let total = 0;
  let receipt = "";

  function login() {
    const u = document.getElementById("username").value;
    const p = document.getElementById("password").value;
    if (credentials[u] === p) {
      document.getElementById("login-screen").classList.remove("active");
      document.getElementById("main").classList.add("active");
      loadProducts();
      startClock();
    } else {
      document.getElementById("login-error").innerText = "ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—ã—ã¾ã—ãŸã€‚";
    }
  }

  function loadProducts() {
    const list = document.getElementById("product-list");
    list.innerHTML = "";
    products.forEach((item, index) => {
      const btn = document.createElement("button");
      btn.innerHTML = `${item.name}<br>Â¥${item.price}<br>æ®‹: ${item.stock}`;
      if (item.stock <= 1) {
        btn.innerHTML += "<br><span class='stock-warning'>åœ¨åº«å°‘</span>";
      }
      btn.onclick = () => {
        if (item.stock > 0) {
          total += item.price;
          item.stock--;
          receipt += `${item.name}ã€€Â¥${item.price}\n`;
          document.getElementById("receipt").innerText = receipt + "\nåˆè¨ˆ: Â¥" + total;
          document.getElementById("beep").play();
          loadProducts();
        } else {
          alert("åœ¨åº«åˆ‡ã‚Œã§ã™ï¼");
        }
      };
      list.appendChild(btn);
    });
  }

  function pay() {
    if (total === 0) {
      alert("å•†å“ãŒé¸ã°ã‚Œã¦ã„ã¾ã›ã‚“ã€‚");
      return;
    }
    receipt += `-------------------\nãŠä¼šè¨ˆ: Â¥${total}\nã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼\n\n`;
    document.getElementById("receipt").innerText = receipt;
    document.getElementById("pay-sound").play();
    total = 0;
    receipt = "";
  }

  function exportCSV() {
    let csv = "å•†å“å,ä¾¡æ ¼,åœ¨åº«\n";
    products.forEach(p => {
      csv += `${p.name},${p.price},${p.stock}\n`;
    });
    const blob = new Blob([csv], { type: "text/csv" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "products.csv";
    link.click();
  }

  function addProduct() {
    const name = prompt("å•†å“åã‚’å…¥åŠ›ï¼ˆçµµæ–‡å­—ã‚‚å¯ï¼‰:");
    const price = parseInt(prompt("ä¾¡æ ¼ã‚’å…¥åŠ›ï¼ˆåŠè§’æ•°å­—ï¼‰:"), 10);
    const stock = parseInt(prompt("åœ¨åº«æ•°ã‚’å…¥åŠ›:"), 10);
    if (name && !isNaN(price) && !isNaN(stock)) {
      products.push({ name, price, stock });
      loadProducts();
    }
  }

  function startClock() {
    setInterval(() => {
      const now = new Date();
      const h = now.getHours().toString().padStart(2, '0');
      const m = now.getMinutes().toString().padStart(2, '0');
      const s = now.getSeconds().toString().padStart(2, '0');
      document.getElementById("clock").innerText = `${h}:${m}:${s}`;
    }, 1000);
  }
</script>
</body>
</html>
